const filterSelect = document.getElementById('media-filter');
    let debounce;
    [searchInput, filterSelect].forEach(el => el.addEventListener('input', () => {
      clearTimeout(debounce);
      debounce = setTimeout(() => {
        fetchAndRender('/search','music-list',{
          term: searchInput.value.trim(),
          media: filterSelect.value,
          limit: 20
        });
      }, 400);
    }));

    // Favoritos
    function addToFavorites(item) {
      const favs = JSON.parse(localStorage.getItem('favs')||'[]');
      if (!favs.some(f => f.trackId === item.trackId)) { 
        favs.push(item); 
        localStorage.setItem('favs', JSON.stringify(favs)); 
        renderFavorites(); 
      }
    }
    
    function renderFavorites() {
      const favs = JSON.parse(localStorage.getItem('favs')||'[]');
      const list = document.getElementById('favorites-list');
      list.innerHTML = favs.length ?
        favs.map(item => `<div class="item"><img src="${item.artworkUrl100}" alt="${item.trackName||item.collectionName}"/><p>${item.trackName||item.collectionName}</p>${item.previewUrl?`<audio controls src="${item.previewUrl}"></audio>`:''}</div>`).join(''):
        '<p style="color:#888;text-align:center;">AÃºn no tienes favoritos</p>';
    }
  </script>
</body>
</html>
